<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>El Rinc√≥n de Chiara</title>
<style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; background: #ecdae8; color: #c2185b; }
    header { background: #fee6e6; padding: 1em; text-align: center; }
    header img { max-width: 300px; height: auto; }
    nav { background: #430936; display: flex; justify-content: center; flex-wrap: wrap; }
    nav a { color: white; text-decoration: none; padding: 1em; font-weight: bold; }
    nav a:hover { background: #f06292; }
    .container { display: grid; grid-template-columns: repeat(auto-fit, minmax(0, 1fr)); gap: 1em; padding: 1em; }
    .product { background: white; padding: 1em; border-radius: 8px; box-shadow: 0 0 8px rgba(0,0,0,0.1); text-align: center; color: #880e4f; }
	.buy-button {
    display: inline-block;
    background: #d81b60;
    color: white;
    padding: 0.5em 1em;
    border-radius: 20px;
    text-decoration: none;
    font-weight: bold;
    margin-top: 0.5em;
    transition: background 0.3s;
}

.buy-button:hover {
    background: #ad1457;
}
	.product img { 
    max-width: 100%; 
    max-height: 250px; 
    height: auto; 
    border-radius: 8px; 
}
    .product img { max-width: 100%; height: auto; border-radius: 8px; }
    footer { background: #f8bbd0; color: #880e4f; text-align: center; padding: 1em; margin-top: 2em; font-weight: bold; }
	.whatsapp-float {
    position: fixed;
    width: 60px;
    height: 60px;
    bottom: 20px;
    right: 20px;
    background: #25d366;
    color: white;
    border-radius: 50%;
    text-align: center;
    font-size: 30px;
    line-height: 60px;
    z-index: 100;
    box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    text-decoration: none;
    transition: transform 0.3s;
}

.whatsapp-float:hover {
    transform: scale(1.1);
}
</style>
</head>
<body>
<header>
    <img src="logo.png" alt="El Rinc√≥n de Chiara">
	<p>Decor√° tu hogar con amor y estilo</p>
</header>
<nav>
    <a href="#bazar">Bazar</a>
    <a href="#blanqueria">Blanquer√≠a</a>
    <a href="#electronica">Electr√≥nica</a>
    <a href="#electrodomesticos">Electrodom√©sticos</a>
    <a href="#hogar">Hogar</a>
	<a href="#indumentaria">Indumentaria</a>
</nav>


<div class="container" id="bazar"></div>
<div class="container" id="blanqueria"></div>
<div class="container" id="electronica"></div>
<div class="container" id="electrodomesticos"></div>
<div class="container" id="hogar"></div>
<div class="container" id="indumentaria"></div>

<footer>
    ¬© 2025 El Rinc√≥n de Chiara | Seguinos en
    <a href="https://www.instagram.com/elrincondechiara" target="_blank">Instagram</a> |
    <a href="mailto:elrincondechiara@gmail.com">Email</a>
</footer>

<a href="https://wa.me/5491150648790" class="whatsapp-float" target="_blank" title="Escribinos por WhatsApp">üí¨</a>


<script>
// Inicializar carrito si no existe
if (!localStorage.getItem('carrito')) {
    localStorage.setItem('carrito', JSON.stringify([]));
}

// Funci√≥n para actualizar el contador flotante
function actualizarContadorCarrito() {
    const carrito = JSON.parse(localStorage.getItem('carrito'));
    const contador = carrito.reduce((acc, item) => acc + item.cantidad, 0);
    document.getElementById('carrito-contador').innerText = contador;
}

// Funci√≥n para agregar producto
function agregarAlCarrito(nombre, precio) {
    const carrito = JSON.parse(localStorage.getItem('carrito'));
    const existente = carrito.find(p => p.nombre === nombre);
    if (existente) {
        existente.cantidad += 1;
    } else {
        carrito.push({ nombre, precio, cantidad: 1 });
    }
    localStorage.setItem('carrito', JSON.stringify(carrito));
    actualizarContadorCarrito();
    alerta(nombre + " agregado al carrito");
}

// Mostrar carrito emergente
function mostrarCarrito() {
    const carrito = JSON.parse(localStorage.getItem('carrito'));
    if (carrito.length === 0) {
        alerta("El carrito est√° vac√≠o.");
        return;
    }
    let mensaje = "üõí Tu carrito:\n";
    let total = 0;
    carrito.forEach(item => {
        mensaje += `‚Ä¢ ${item.nombre} x${item.cantidad} - $${item.precio * item.cantidad}\n`;
        total += item.precio * item.cantidad;
    });
    mensaje += `\nTotal: $${total}\n\n¬øDeseas enviar este pedido por WhatsApp?`;

    confirmar(mensaje).then((respuesta) => {
        if (respuesta) {
            const texto = encodeURIComponent(`Hola, quiero comprar:\n${mensaje}`);
            window.open(`https://wa.me/5491150648790?text=${texto}`, "_blank");
        }
    });
}


// Inicializar contador al cargar
document.addEventListener('DOMContentLoaded', actualizarContadorCarrito);

// Funci√≥n para vaciar carrito
async function vaciarCarrito() {
    const respuesta = await confirmar("¬øEst√°s seguro de que deseas vaciar el carrito?");
    if (respuesta) {
        localStorage.setItem('carrito', JSON.stringify([]));
        actualizarContadorCarrito();
        alerta("El carrito ha sido vaciado.");
    }
}
</script>

<script>
// Modal reutilizable
function mostrarModal(mensaje, esConfirmacion = false) {
    return new Promise((resolve) => {
        const modal = document.getElementById('modal');
        const modalMessage = document.getElementById('modal-message');
        const modalOk = document.getElementById('modal-ok');
        const modalCancel = document.getElementById('modal-cancel');

        modalMessage.textContent = mensaje;
        modal.style.display = 'flex';
        modalCancel.style.display = esConfirmacion ? 'inline-block' : 'none';

        function cerrar(resultado) {
            modal.style.display = 'none';
            modalOk.removeEventListener('click', onOk);
            modalCancel.removeEventListener('click', onCancel);
            document.removeEventListener('keydown', onKey);
            resolve(resultado);
        }

        function onOk() { cerrar(true); }
        function onCancel() { cerrar(false); }
        function onKey(e) { if (e.key === "Escape") cerrar(false); }

        modalOk.addEventListener('click', onOk);
        modalCancel.addEventListener('click', onCancel);
        document.addEventListener('keydown', onKey);
    });
}

// Reemplazo de alert
async function alerta(mensaje) {
    await mostrarModal(mensaje, false);
}

// Reemplazo de confirm
async function confirmar(mensaje) {
    const respuesta = await mostrarModal(mensaje, true);
    return respuesta;
}
</script>

<script>
// Delegaci√≥n de eventos para todos los botones de "Agregar al carrito"
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.buy-button').forEach(boton => {
        boton.addEventListener('click', function() {
            const producto = boton.closest('.product');
            const nombre = producto.getAttribute('data-nombre');
            const precio = parseInt(producto.getAttribute('data-precio'));
            agregarAlCarrito(nombre, precio);
        });
    });
});
</script>


<!-- Bot√≥n flotante de carrito (ya existente) -->
<a href="javascript:void(0);" class="whatsapp-float" onclick="mostrarCarrito()" title="Ver carrito">
    üõí<span id="carrito-contador" style="font-size:0.5em; position:absolute; top:5px; right:5px; background:#f44336; color:white; border-radius:50%; width:20px; height:20px; display:flex; align-items:center; justify-content:center;">0</span>
</a>

<!-- Bot√≥n flotante para vaciar carrito -->
<a href="javascript:void(0);" onclick="vaciarCarrito()" class="whatsapp-float"
   style="right: 90px; background:#f44336;" title="Vaciar carrito">üóëÔ∏è</a>
   
<div id="modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:999; align-items:center; justify-content:center;">
    <div style="background:white; color:#880e4f; max-width:90%; width:300px; border-radius:8px; padding:1em; text-align:center; font-family:'Segoe UI', sans-serif; position:relative;">
        <h3 id="modal-title" style="margin-top:0;">El Rinc√≥n de Chiara</h3>
        <p id="modal-message">Mensaje</p>
        <div style="margin-top:1em;">
            <button id="modal-ok" style="background:#d81b60; color:white; border:none; padding:0.5em 1em; border-radius:20px; font-weight:bold; cursor:pointer; margin:0 0.5em;">Aceptar</button>
            <button id="modal-cancel" style="background:#ccc; color:#333; border:none; padding:0.5em 1em; border-radius:20px; font-weight:bold; cursor:pointer; margin:0 0.5em; display:none;">Cancelar</button>
        </div>
    </div>
</div>

<!-- Bot√≥n de pago Mercado Pago -->
<a href="javascript:void(0);" onclick="pagarConMercadoPago()" class="whatsapp-float"
   style="right: 160px; background:#009ee3;" title="Pagar con Mercado Pago">üí≥</a>

<script>
async function pagarConMercadoPago() {
    const carrito = JSON.parse(localStorage.getItem('carrito'));
    if (!carrito || carrito.length === 0) {
        alerta("El carrito est√° vac√≠o. Agrega productos antes de pagar.");
        return;
    }

    // Convertir a estructura para Mercado Pago
    const items = carrito.map(item => ({
        title: item.nombre,
        quantity: item.cantidad,
        unit_price: item.precio
    }));

    try {
        const respuesta = await fetch("https://mitienda-ftxw.onrender.com/crear-preferencia", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ items })
        });

        if (!respuesta.ok) {
            throw new Error("Error al crear preferencia");
        }

        const data = await respuesta.json();
        // Redirigir al checkout de Mercado Pago
        window.location.href = data.init_point;
    } catch (error) {
        console.error(error);
        alerta("Ocurri√≥ un error al iniciar el pago. Verific√° tu conexi√≥n o intenta m√°s tarde.");
    }
}
</script>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const url = 'https://opensheet.elk.sh/12ij43IAUUSJDJTKKLJ9xxJ6hBUxKN0YOAcVj2PUOry8/Lista';

    fetch(url)
        .then(response => response.json())
        .then(data => mostrarProductos(data))
        .catch(error => {
            console.error("Error cargando productos:", error);
        });

    function mostrarProductos(data) {
        const contenedores = {
			bazar: document.getElementById('bazar'),
            blanqueria: document.getElementById('blanqueria'),
            electronica: document.getElementById('electronica'),
            electrodomesticos: document.getElementById('electrodomesticos'),
            hogar: document.getElementById('hogar'),
			indumentaria: document.getElementById('indumentaria')
        };

        data.forEach(producto => {
            const categoria = producto.categoria?.toLowerCase().trim();
            if (!contenedores[categoria]) return;

            const div = document.createElement('div');
            div.className = 'product';
            div.setAttribute('data-nombre', producto.nombre);
            div.setAttribute('data-precio', producto.precio);

            div.innerHTML = `
                <img src="${producto.imagen}" alt="${producto.nombre}" title="${producto.nombre} - $${producto.precio} - ${producto.descripcion}">
                <h3>${producto.nombre}</h3>
                <p>$${producto.precio}</p>
                <p>${producto.descripcion}</p>
                <a href="javascript:void(0);" class="buy-button">Agregar al carrito</a>
            `;

            contenedores[categoria].appendChild(div);
        });

        // Delegar eventos a los botones agregados
        document.querySelectorAll('.buy-button').forEach(boton => {
            boton.addEventListener('click', function() {
                const producto = boton.closest('.product');
                const nombre = producto.getAttribute('data-nombre');
                const precio = parseInt(producto.getAttribute('data-precio'));
                agregarAlCarrito(nombre, precio);
            });
        });
    }
});
</script>



</body>
</html>
